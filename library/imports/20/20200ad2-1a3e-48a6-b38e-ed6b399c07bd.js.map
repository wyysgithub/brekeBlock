{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\ball.js"],"names":["cc","Class","extends","Component","properties","baseSpeed","speedPercent","baseArea","areaPercent","attack","ballNum","onLoad","baffle","find","gameMain","getComponent","waiting","msg","timeout","Label","active","userInfo","ballNumLabel","levelBlockNode","RigidBody","setArea","setSpeed","linearVelocity","p","node","width","height","physicsCircle","PhysicsCircleCollider","radius","apply","resetPosition","string","ballRun","_x","x","_y","setPosition","v2","num","schedule","bind","scheduleOnce","getBlockNum","surplusBlock","childrenCount","passLevel","start","update","dt","y","gameOver","onBeginContact","contact","selfCollider","otherCollider","onEndContact","groupIndex","defense","destroy","onPreSolve","onPostSolve","onCollisionStay","other","self","attackGrow","attach","speedGrow","percent","areaGrow"],"mappings":"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","file":"ball.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        baseSpeed:800,\r\n        speedPercent: 1,\r\n        baseArea: 30,\r\n        areaPercent: 1,\r\n        attack: 1,\r\n        ballNum: 3\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        this.baffle = cc.find(\"UI_ROOT/baffle\");\r\n        this.gameMain = cc.find(\"UI_ROOT\").getComponent(\"gameMain\");\r\n        this.waiting = cc.find(\"UI_ROOT/waiting\");\r\n        // 发球倒计时\r\n        this.msg = cc.find(\"UI_ROOT/msg\")\r\n        this.timeout = cc.find(\"UI_ROOT/msg/timeout\").getComponent(cc.Label)\r\n        this.msg.active = false;\r\n        // 球数显示\r\n        this.userInfo = cc.find(\"UI_ROOT/userInfo\")\r\n        this.ballNumLabel = cc.find(\"UI_ROOT/userInfo/ballNum\").getComponent(cc.Label)\r\n        // 砖块列表\r\n        this.levelBlockNode = cc.find(\"UI_ROOT/levelBlock\");\r\n\r\n\r\n\r\n        this.RigidBody = this.getComponent(cc.RigidBody);\r\n\r\n        this.setArea(this.areaPercent);\r\n\r\n\r\n    },\r\n\r\n    setSpeed(speedPercent) {\r\n        // var velocity = this.RigidBody.linearVelocity;\r\n        //\r\n        // velocity.x = 500 * speedPercent;\r\n        // velocity.y = 500 * speedPercent;\r\n\r\n        this.RigidBody.linearVelocity = cc.p(this.baseSpeed * speedPercent, this.baseSpeed * speedPercent);\r\n\r\n    },\r\n    setArea(areaPercent) {\r\n\r\n        // 图形大小\r\n        this.node.width = this.baseArea * areaPercent;\r\n        this.node.height = this.baseArea * areaPercent;\r\n\r\n        // 刚体大小\r\n        var physicsCircle = this.getComponent(cc.PhysicsCircleCollider);\r\n        physicsCircle.radius = this.baseArea / 2  * areaPercent;\r\n\r\n        physicsCircle.apply();\r\n\r\n    },\r\n\r\n    resetPosition() {\r\n        // 展示球数\r\n        this.ballNumLabel.string = 'x  '+ this.ballNum;\r\n\r\n        this.ballRun = false;\r\n        // 清除速度\r\n        this.setSpeed(0);\r\n\r\n        // 板的位置\r\n        var _x = this.baffle.x;\r\n\r\n        var _y = this.node.width / 2 - 460;\r\n\r\n        this.node.setPosition(cc.v2(_x, _y));\r\n\r\n        this.timeout.string = '3'\r\n        var num = 2;\r\n        this.msg.active = true;\r\n        this.schedule(function () {\r\n            this.timeout.string = '' + num;\r\n            num -= 1;\r\n        }.bind(this), 1, 3)\r\n        //3秒后发球\r\n        this.scheduleOnce(function () {\r\n            this.ballRun = true;\r\n            this.setSpeed(this.speedPercent);\r\n            this.msg.active = false;\r\n        }.bind(this), 3)\r\n    },\r\n    // 获取剩下砖块数\r\n    getBlockNum(){\r\n        var surplusBlock = this.levelBlockNode.childrenCount;\r\n        if(this.levelBlockNode.childrenCount == 0){\r\n            // 通关\r\n            this.gameMain.passLevel()\r\n        }\r\n        \r\n    },\r\n    start() {\r\n\r\n    },\r\n\r\n    update(dt) {\r\n        if (this.node.y < -640) {\r\n            this.ballNum -= 1;\r\n\r\n            if (this.ballNum >= 0) {\r\n                this.resetPosition();\r\n            } else {\r\n                // 球用完 游戏结束\r\n                this.node.active = false;\r\n                this.gameMain.gameOver()\r\n            }\r\n        }\r\n    },\r\n\r\n    // 刚体碰撞\r\n    // 只在两个碰撞体开始接触时被调用一次\r\n    onBeginContact: function (contact, selfCollider, otherCollider) {\r\n\r\n    },\r\n\r\n    // 只在两个碰撞体结束接触时被调用一次\r\n    onEndContact: function (contact, selfCollider, otherCollider) {\r\n        if (otherCollider.node.groupIndex === 3) {\r\n            if(this.attack >= otherCollider.node.getComponent(\"block\").defense){\r\n                otherCollider.node.destroy();\r\n                this.scheduleOnce(function () {\r\n                    this.getBlockNum()\r\n                }.bind(this),0.2)\r\n            }else {\r\n                otherCollider.node.getComponent(\"block\").defense -= this.attack;\r\n            }\r\n        }\r\n    },\r\n\r\n    // 每次将要处理碰撞体接触逻辑时被调用\r\n    onPreSolve: function (contact, selfCollider, otherCollider) {\r\n    },\r\n\r\n    // 每次处理完碰撞体接触逻辑时被调用\r\n    onPostSolve: function (contact, selfCollider, otherCollider) {\r\n    },\r\n\r\n    //碰撞\r\n    onCollisionStay: function (other, self) {\r\n        if (this.attack === 1) {\r\n            return;\r\n        }\r\n        if (other.node.groupIndex === 3) {\r\n            if (this.attack > other.node.getComponent(\"block\").defense) {\r\n                other.node.destroy();\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    //************** 能力强化  球 ***********\r\n\r\n    attackGrow(num) {\r\n        this.attach += num;\r\n    },\r\n    speedGrow(percent) {\r\n        this.speedPercent += percent;\r\n        // this.setSpeed(this.speedPercent);\r\n    },\r\n    areaGrow(percent) {\r\n        this.areaPercent += percent;\r\n        this.setArea(this.areaPercent);\r\n    }\r\n\r\n});\r\n"]}